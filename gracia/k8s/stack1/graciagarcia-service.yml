# ========================================
# STACK 1 - SERVICE (NodePort)
# ========================================
# Archivo: gracia/k8s/stack1/graciagarcia-service.yml
# Descripción: Expone la aplicación al exterior mediante NodePort
# 
# COMANDO PARA APLICAR:
# kubectl apply -f k8s/stack1/graciagarcia-service.yml
#
# COMANDOS PARA VERIFICAR:
# kubectl get service -n graciagarcia-namespace
# kubectl describe service graciagarcia-service -n graciagarcia-namespace
# curl http://localhost:30093/v1/api/student
#
# ACCESO:
# http://localhost:30093/v1/api/student
# ========================================

apiVersion: v1                          # Versión de la API de Kubernetes
kind: Service                           # Tipo de recurso: Service (servicio de red)
metadata:                               # Metadatos del service
  name: graciagarcia-service            # Nombre del service
  namespace: graciagarcia-namespace     # Namespace donde se crea
  labels:                               # Etiquetas del service
    app: graciagarcia-app               # Etiqueta de la aplicación
    owner: graciagarcia                 # Propietario
spec:                                   # Especificación del service
  type: NodePort                        # Tipo: NodePort (expone puerto en el nodo)
  selector:                             # Selector para encontrar los pods
    app: graciagarcia-app               # Selecciona pods con esta etiqueta
  ports:                                # Configuración de puertos
  - name: http                          # Nombre del puerto
    protocol: TCP                       # Protocolo TCP
    port: 80                            # Puerto del service (interno)
    targetPort: 8093                    # Puerto del contenedor (donde escucha la app)
    nodePort: 30093                     # Puerto externo (acceso desde localhost)
  sessionAffinity: None                 # Sin afinidad de sesión (balanceo round-robin)
